{% extends "base.html" %}

{% block title %}Problem #{{ problem.id }}{% endblock %}

{% block submenu_append %}
  <li class='active'>
    <a href=''>Problem #{{ problem.id }}</a>
  </li>
{% endblock %}

{% block extrahead %}
  <script type="text/javascript" src="/js/bootstrap/bootstrap.js"></script>
{% endblock %}

{% block content %}
<div class='problem'>
  <div class='row'>
    <div class='span6'>
      <h3>Here be graphs</h3>
    </div>
    <div class='span6 statistics'>
      <h3>Statistics</h3>
      <table class="table table-striped table-bordered">
        <tr>
          <th>Operating system</th>
          <th>Count</th>
        </tr>
        {% for release, cnt in osreleases %}
        <tr>
          <td>{{ release.opsys.name }} {{ release.version }}</td>
          <td>{{ cnt }}</td>
        </tr>
        {% endfor %}
      </table>

      <table class="table table-striped table-bordered">
        <tr>
          <th>Architecture</th>
          <th>Count</th>
        </tr>
        {% for arch, cnt in arches %}
        <tr>
          <td>{{ arch.name }}</td>
          <td>{{ cnt }}</td>
        </tr>
        {% endfor %}
      </table>

      <table class="table table-striped table-bordered">
        <tr>
          <th>Executable</th>
          <th>Count</th>
        </tr>
        {% for exe, cnt in exes %}
        <tr>
          <td>{{ exe }}</td>
          <td>{{ cnt }}</td>
        </tr>
        {% endfor %}
      </table>

      <table class="table table-striped table-bordered">
        <tr>
          <th>Package</th>
          <th>Count</th>
        </tr>
        {% for package, cnt in packages %}
        <tr>
          <td>{{ package }}</td>
          <td>{{ cnt }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>

  <br />

  <h3>Report backtrace</h3>
  <ul class="nav nav-tabs">
    {% for report in problem.reports %}
      <li
        {% if forloop.first %}
          class="active"
        {% endif %}
      >
        <a href="#{{ report.id }}" data-toggle="tab">{{ report.id }}</a>
      </li>
    {% endfor %}
  </ul>

  <div class="tab-content">
    {% for report in problem.reports %}
      <div class="tab-pane
        {% if forloop.first %}
          active
        {% endif %}
      " id="{{ report.id }}">


        {% with report.backtraces.0.frames as backtrace %}
          {% include 'reports/backtrace.html' %}
        {% endwith %}

        <div class="btn-group pull-right">
          <a class='btn' href={% url pyfaf.hub.reports.views.item report.id %}
          >View complete report</a>
        </div>
      </div>
    {% endfor %}
  </div>

</div>
{% endblock %}
