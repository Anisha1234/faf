{% extends "base.html" %}

{% block title %}Report #{{ report.0.id }}{% endblock %}

{% block submenu_prepend %}
  <li class='active'>
    <a href=''>Report #{{ report.0.id }}</a>
  </li>
{% endblock %}

{% block content %}
  <div id='report'>
    <dl>
      <dt>Problem</dt>
      <dd>
        {% if report.0.problem_id %}
          <a href='{% url pyfaf.hub.problems.views.summary report.0.problem_id %}'
            >{{report.0.problem_id}}</a>
        {% else %}
          <em>An owning problem doesn't exist yet.</em>
        {% endif %}
      </dd>
      <dt>Component</dt>
      <dd>{{report.1.name}}</dd>
      <dt>Operating System</dt>
      <dd>{{report.2.name}}</dd>
      <dt>Created</dt>
      <dd>{{report.0.first_occurence|date:"Y-m-d"}}</dd>
      <dt>Last change</dt>
      <dd>{{report.0.last_occurence|date:"Y-m-d"}}</dd>
    </dl>

    <br />

    {% with 'Packages' as packagelist_caption %}
      {% with crashed_packages as packages %}
        {% include 'reports/packages.html' %}
      {% endwith %}
    {% endwith %}

    {% with 'Related packages' as packagelist_caption %}
      {% with related_packages as packages %}
        {% include 'reports/packages.html' %}
      {% endwith %}
    {% endwith %}

    <br />

    <div class='row'>
      <div class='span12'>
        <h3>History</h3>
      </div>
      <div class='span4'>
        <h4>Daily:</h4>
        {% with daily_history as history %}
          {% with 'daily' as datefmt %}
            {% include 'reports/history_table.html' %}
          {% endwith %}
        {% endwith %}
      </div>

      <div class='span4'>
        <h4>Weekly:</h4>
        {% with weekly_history as history %}
          {% with 'weekly' as datefmt %}
            {% include 'reports/history_table.html' %}
          {% endwith %}
        {% endwith %}
      </div>

      <div class='span4'>
        <h4>Monthly:</h4>
        {% with monthly_history as history %}
          {% with 'monthly' as datefmt %}
            {% include 'reports/history_table.html' %}
          {% endwith %}
        {% endwith %}
      </div>
    </div>

    <br />

    <h3>Backtrace</h3>
    <table class="table table-striped table-bordered">
      <tr>
        <th>Frame #</th>
        <th>Function</th>
        <th>Binary</th>
        <th>Source</th>
        <th>Line</th>
      </tr>
      {% for frame in backtrace %}
        <tr>
          <td>{{ frame.order }}</td>
          <td>{{ frame.symbolsource.symbol.name }}</td>
          <td>{{ frame.symbolsource.path }}</td>
          <td>{{ frame.symbolsource.source_path }}</td>
          <td>{{ frame.symbolsource.line_number }}</td>
        </tr>
      {% endfor %}
    </table>
  </div>
{% endblock %}
