{% extends "base.html" %}

{% block title %}Report #{{ report.id }}{% endblock %}

{% block submenu_append %}
  <li class='active'>
    <a href=''>Report #{{ report.id }}</a>
  </li>
{% endblock %}

{% block content %}
  <div id='report'>
    <dl>
      <dt>Problem</dt>
      <dd>
        {% if report.problem_id %}
          <a href='{% url pyfaf.hub.problems.views.summary report.problem_id %}'
            >{{ report.problem_id }}</a>
        {% else %}
          <em>An owning problem doesn't exist yet.</em>
        {% endif %}
      </dd>
      <dt>Component</dt>
      <dd>{{ component.name }}</dd>
      <dt>Operating System</dt>
        <dd>
          {% for release in releases %}
            {{ release.OpSys.name }} {{ release.OpSysRelease.version }}
            {% if not forloop.last %}
            ,
            {% endif %}
          {% endfor %}
        </dd>
      <dt>Created</dt>
      <dd>{{ report.first_occurence|date:"Y-m-d" }}</dd>
      <dt>Last change</dt>
      <dd>{{ report.last_occurence|date:"Y-m-d" }}</dd>
    </dl>

    <br />

    {% with crashed_packages as packages %}
      {% if packages %}
        <h4>Packages</h4>
        {% include 'reports/packages.html' %}
      {% endif %}
    {% endwith %}

    {% with related_packages as packages %}
      {% if packages %}
        <h4>Related packages</h4>
        {% include 'reports/packages.html' %}
      {% endif %}
    {% endwith %}

    <br />

    <div class='row'>
      <div class='span12'>
        <h3>History</h3>
      </div>
      <div class='span4'>
        <h4>Daily:</h4>
        {% with daily_history as history %}
          {% with 'daily' as datefmt %}
            {% include 'reports/history_table.html' %}
          {% endwith %}
        {% endwith %}
      </div>

      <div class='span4'>
        <h4>Weekly:</h4>
        {% with weekly_history as history %}
          {% with 'weekly' as datefmt %}
            {% include 'reports/history_table.html' %}
          {% endwith %}
        {% endwith %}
      </div>

      <div class='span4'>
        <h4>Monthly:</h4>
        {% with monthly_history as history %}
          {% with 'monthly' as datefmt %}
            {% include 'reports/history_table.html' %}
          {% endwith %}
        {% endwith %}
      </div>
    </div>

    <br />

    <h3>Backtrace</h3>
    {% include 'reports/backtrace.html' %}

  </div>
{% endblock %}
