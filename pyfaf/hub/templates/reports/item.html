{% extends "base.html" %}

{% block title %}Report #{{ report.0.id }}{% endblock %}

{% block content %}
<h2>Report details.</h2>
<dl>
    <dt>ID</dt>
    <dd>{{report.0.id}}</dd>
    <dt>Problem</dt>
    <dd>
        {% if report.0.problem_id %}
            <a href={% url pyfaf.hub.problems.views.summary report.0.problem_id %}>{{report.0.problem_id}}</a>
        {% else %}
            <em>An owning problem doesn't exist yet.</em>
        {% endif %}
    </dd>
    <dt>Component</dt>
    <dd>{{report.1.name}}</dd>
    <dt>Operating System</dt>
    <dd>{{report.2.name}}</dd>
    <dt>Created</dt>
    <dd>{{report.0.first_occurence|date:"Y-m-d"}}</dd>
    <dt>Last change</dt>
    <dd>{{report.0.last_occurence|date:"Y-m-d"}}</dd>
</dl>

<h3>Packages:</h3>
<table class="table table-striped table-bordered">
    <tr>
        <th>Name</th>
        <th>Installed</th>
        <th>Running</th>
        <th>Count</th>
    </tr>
    <!-- Ask Richard to take a look at it and advise me how to write a template -->
{% for package in packages %}
    <tr>
        <td>
        {% if package.iname != None %}
            {{package.iname}}
        {% else %}
            {{package.rname}}
        {% endif %}
        </td>
        <td>
        {% if package.iversion != None %}
            {{package.iepoch}}:{{package.iversion}}-{{package.irelease}}
        {% endif %}
        </td>
        <td>
        {% if package.rversion != None %}
            {{package.repoch}}:{{package.rversion}}-{{package.rrelease}}
        {% endif %}
        </td>
        <td>{{package.count}}</td>
    </tr>
{% endfor %}
    <tr><td colspan=6>Related</td><tr/>
{% for package in related_packages %}
    <tr>
        <td>
        {% if package.iname != None %}
            {{package.iname}}
        {% else %}
            {{package.rname}}
        {% endif %}
        </td>
        <td>
        {% if package.iversion != None %}
            {{package.iepoch}}:{{package.iversion}}-{{package.irelease}}
        {% endif %}
        </td>
        <td>
        {% if package.rversion != None %}
            {{package.repoch}}:{{package.rversion}}-{{package.rrelease}}
        {% endif %}
        </td>
        <td>{{package.count}}</td>
    </tr>
{% endfor %}
</table>

<h3>History Daily:</h3>
<table>
    <tr><th>Day</th><th>Count</th></tr>
{% for hist in daily_history %}
    <tr><td>{{hist.day|date:"c"}}</td><td>{{hist.count}}</td></tr>
{% endfor %}
</table>

<h3>History Weekly:</h3>
<table>
    <tr><th>Week</th><th>Count</th></tr>
{% for hist in weekly_history %}
    <tr><td>{{hist.week|date:"c (W.)"}}</td><td>{{hist.count}}</td></tr>
{% endfor %}
</table>

<h3>History Monthly:</h3>
<table>
    <tr><th>Month</th><th>Count</th></tr>
{% for hist in monthly_history %}
    <tr><td>{{hist.month|date:"Y-m"}}</td><td>{{hist.count}}</td></tr>
{% endfor %}
</table>

<h3>Backtrace</h3>
<table>
    <tr>
        <th>Frame #</th>
        <th>Function</th>
        <th>Binary</th>
        <th>Source</th>
        <th>Line</th>
    </tr>
{% for frame in backtrace %}
    <tr>
        <td>{{ frame.order }}</td>
        <td>{{ frame.symbolsource.symbol.name }}</td>
        <td>{{ frame.symbolsource.path }}</td>
        <td>{{ frame.symbolsource.source_path }}</td>
        <td>{{ frame.symbolsource.line_number }}</td>
    </tr>
{% endfor %}
</table>
{% endblock %}
